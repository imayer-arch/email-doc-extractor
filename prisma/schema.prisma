// This is your Prisma schema file,
// learn more about it in the docs: https://pris.ly/d/prisma-schema

generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model ExtractedDocument {
  id             String   @id @default(uuid())
  emailId        String   @map("email_id")
  emailSubject   String?  @map("email_subject")
  emailFrom      String?  @map("email_from")
  emailDate      DateTime? @map("email_date")
  fileName       String   @map("file_name")
  fileType       String?  @map("file_type")
  extractedAt    DateTime @default(now()) @map("extracted_at")
  rawText        String?  @map("raw_text")
  structuredData Json?    @map("structured_data")
  tablesData     Json?    @map("tables_data")
  confidence     Float?   @map("confidence")
  status         String   @default("pending") @map("status")
  errorMessage   String?  @map("error_message")
  notifiedAt     DateTime? @map("notified_at")
  createdAt      DateTime @default(now()) @map("created_at")
  updatedAt      DateTime @updatedAt @map("updated_at")

  @@map("extracted_documents")
  @@index([emailId])
  @@index([status])
  @@index([extractedAt])
}

model ProcessedEmail {
  id          String   @id @default(uuid())
  emailId     String   @unique @map("email_id")
  processedAt DateTime @default(now()) @map("processed_at")
  
  @@map("processed_emails")
}
